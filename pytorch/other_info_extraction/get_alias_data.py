#!/usr/bin/env python
# -*- coding: utf-8 -*-
# Copyright (c) ***
"""
    别名简称抽取
"""
import re
import pandas as pd
data_path = "D:\data\\tianjin_dataset\\tj_event\\trz_events.csv"

pattern_list = ["（简称“([\u4e00-\u9fa5]+?)”）",
                    "（以下简称：([\u4e00-\u9fa5]+?)）",
                    "（以下简称“([\u4e00-\u9fa5]+?)”）",
                    "\(以下简称([\u4e00-\u9fa5]+?)\)",
                    "\(简称：([\u4e00-\u9fa5]+?)\)",
                    "（简称([\u4e00-\u9fa5]+?)）",
                    "（简称：([\u4e00-\u9fa5]+?)）",
                    "（下文简称“([\u4e00-\u9fa5]+?)”）",
                    "\(下文简称“([\u4e00-\u9fa5]+?)”\)",
                    "（公司简称：([\u4e00-\u9fa5]+?)）",
                    "（以下简称：([\u4e00-\u9fa5]+?),\d{6}.SH）",
                    "（简称“([\u4e00-\u9fa5]+?)”，股票代码\d{6}）",
                    "\(以下简称“([\u4e00-\u9fa5]+?)”\)",
                    "\(简称“([\u4e00-\u9fa5]+?)”\)",
                    "（以下简称“([\u4e00-\u9fa5]+?)”或“公司”）",
                    "（公司简称：([\u4e00-\u9fa5]+?)，证券代码：\d{6}.SZ）",
                    "（以下简称「([\u4e00-\u9fa5]+?)」）",
                    "（下简称“([\u4e00-\u9fa5]+?)”）",
                    "\(以下简称：([\u4e00-\u9fa5]+?)，",
                    "\(以下简称：([\u4e00-\u9fa5]+?)\)",
                    "（下简称([\u4e00-\u9fa5]+?)）",
                    "（以下简称([\u4e00-\u9fa5]+?)）",
                    "（以下简称“([\u4e00-\u9fa5]+?)“或”公司“）",
                    "\(\d{4}.HK，以下简称“([\u4e00-\u9fa5]+?)”\)",
                    "\(简称\"([\u4e00-\u9fa5]+?)\"\)",
                    "（证券简称：([\u4e00-\u9fa5]+?)）",
                    "\(\d{6}\.SH，简称“(ST[\u4e00-\u9fa5]+?)”\)",
                    "（简称“([\u4e00-\u9fa5]+?)”或“公司”）",
                    "（以下简称 “([\u4e00-\u9fa5]+?)”）",
                    "（以下简称 ：([\u4e00-\u9fa5]+?)）",
                    "（以下简称\"([\u4e00-\u9fa5]+?)\"）",
                    "\(NEEQ:\d{6}，以下简称：([\u4e00-\u9fa5]+?)\)",
                    "\(\d{6}.SZ，以下简称：([\u4e00-\u9fa5]+?)\)",
                    "（下简称：([\u4e00-\u9fa5]+?)）",
                    "（以下简称为“([\u4e00-\u9fa5]+?)”）",
                    "（简称，([\u4e00-\u9fa5]+?)）",
                    "\(以下简称“([\u4e00-\u9fa5]+?)”，"]


data = pd.read_csv(data_path, encoding="gbk")
print(data.shape)
data_train = []
hit = 0
for idx, dt in data.iterrows():
    if isinstance(dt["content"], float):
        continue

    data_list = re.split(r"[。！；\n]", dt["content"])
    for dt in data_list:
        if "简称" in dt:
            state = 0
            rs = []
            for pattern in pattern_list:
                res = re.findall(pattern, dt)

                if res:
                    rs += [(r.group(1), r.span(1)) for r in re.finditer(pattern, dt)]
                    # data_train.append((dt, ))
                    # hit += 1
                    # print(res)
                    state = 1
            # if state == 0:
            rs.sort(key=lambda x: x[1][0])
            data_train.append((dt, rs))

data_label = [
    [],
    [(1, "宁波梅山保税港区樾宸投资管理有限公司", 0)],
    [(2, "京东方科技集团股份有限公司", 0), (2, "天津京东方创新投资有限公司", 0), (2, "北京燕东微电子股份有限公司", 0)],
    [(3, "上海迈铸半导体科技有限公司", 0)],
    [(4, "中微半导体设备（上海）股份有限公司", 0)],
    [(5, "深圳市洪堡智慧餐饮科技有限公司", 0)],
    [(6, "苏州捷研芯电子科技有限公司", 0)],
    [(7, "杭州朗迅科技有限公司", 0)],
    [(8, "厦门元初食品（需求面积:100-200平方米）股份有限公司", 0)],
    [(9, "广州追光科技有限公司", 0)],
    [(10, "深圳芯能半导体技术有限公司", 0)],
    [],
    [(12, "深圳招商商置投资有限公司", 0)],
    [(13, "无锡沐创集成电路设计有限公司", 0)],
    [(14, "红杉资本中国基金", 0)],
    [(15, "北京大禹智芯科技有限公司", 0)],
    [(16, "常州韦斯佰瑞电子科技有限公司", 0)],
    [(17, "珠海晶讯聚震科技有限公司", 0)],
    [(18, "泰斗微电子科技有限公司", 0)],
    [(19, "江苏芯德半导体科技有限公司", 0)],
    [(20, "金仕生物科技(常熟)有限公司", 0)],
    [(21, "上海康景生物医药科技有限公司", 0)],
    [(22, "迦美信芯通讯技术有限公司", 0)],
    [(23, "国银金融租赁股份有限公", 0)],
    [(24, "上海中闻金泰半导体有限公司", 0), (24, "上海闻芯企业管理合伙企业(有限合伙)", 0)],
    [(25, "上海赛美特软件科技有限公司", 0)],
    [(26, "北京中科弧光量子软件技术有限公司", 0)],
    [(27, "深圳有为技术控股集团有限公司", 0)],
    [(28, "光惠(上海)激光科技有限公司", 0)],
    [(29, "光惠激光", 0, "GW", 1)],
    [(30, "常州纵慧芯光半导体科技有限公司", 0)],
    [(31, "安踏体育用品有限公司", 0)],
    [(32, "上海芯联芯智能科技有限公司", 0)],
    [(33, "广东欧莱高新材料股份有限公司", 0)],
    [(34, "北京卓视智通科技有限责任公司", 0)],
    [(35, "立芯科技股份有限公司", 0)],
    [(36, "武汉汉烯科技有限公司", 0)],
    [(37, "上海天数智芯半导体有限公司", 0)],
    [],
    [(39, "Particle Fever粒子狂热", 0, "PF", 0)],
    [(40, "浙江赛思电子科技有限公司", 0)],
    [(41, "SECRE时萃咖啡", 0)],
    [],
    [(43, "福建德尔科技有限公司", 0)],
    [(44, "武汉杰开科技有限公司", 0)],
    [(45, "武汉汉烯科技有限公司", 0)],
    [(46, "西安智多晶微电子有限公司", 0)],
    [(47, "上海先楫半导体科技有限公司", 0)],
    [],
    [(49, "福建蓝海黑石新材料科技有限公司", 0), (49, "中航国际投资有限公司旗下投资基金", 0)],
    [(50, "虎头局·渣打饼行", 0)],
    [(51, "Herschel Supply Co.", 0, "Herschel", 1)],
    [(52, "深圳慧能泰半导体科技有限公司", 0)],
    [(53, "Rock Bear 超级萌工厂", 0)],
    [(54, "泰斗微电子科技有限公司", 0)],
    [(55, "宁波道充科技有限公司", 0)],
    [(56, "上海禾赛科技有限公司", 0)],
    [(57, "深圳市艾德光子有限公司", 0)],
    [(58, "广西芯百特微电子有限公司", 0)],
    [(59, "湖南比邻星科技有限公司", 0)],
    [(60, "《重庆市制造业高质量发展“十四五”规划（2021—2025年）》", 0, "《规划》", 0)],
    [],
    [(62, "广州巨湾技研有限公司", 0)],
    [(63, "广西芯百特微电子有限公司", 0)],
    [(64, "奥比中光科技集团股份有限公司", 0)],
    [(65, "广州海珠万达广场商业管理有限公司", 0), (65, "万达商业管理集团有限公司", 0), (65, "大连万达商业管理集团股份有限公司", 0)],
    [(66, "金仕生物科技(常熟)有限公司", 0)],
    [(67, "奢交圈（需求面积:10-80平方米）TiAMOO", 0)],
    [(68, "武汉环宇智行科技有限公司", 0)],
    [(69, "苏州纳芯微电子股份有限公司", 0)],
    [(70, "上扬软件(上海)有限公司", 0)],
    [(71, "贸易金融区块链平台", 0), (71, "香港贸易联动平台", 0)],
    [(72, "泰斗微电子科技有限公司", 0)],
    [(73, "武汉锐科光纤激光技术股份有限公司", 0)],
    [(74, "PARTY KING（需求面积:1500-3000平方米）运动街区", 0, "PARTY KING", 1)],
    [(75, "Mr Zoo 小小动物元", 0)],
    [(76, "江苏常荣电器股份有限公司", 0)],
    [(77, "泛鼎国际集团", 0)],
    [(78, "泛鼎国际集团", 0)],
    [(79, "南京宏泰半导体科技有限公司", 0)],
    [(80, "黑芝麻智能科技有限公司", 0)],
    [(81, "嘉兴源阳股权投资合伙企业（有限合伙）", 0), (81, "厦门曦煜股权投资合伙企业（有限合伙）", 0), (81, "北京芯能电子科技有限公司", 0)],
    [(82, "北京梦之墨科技有限公司", 0)],
    [(83, "成都氮矽科技有限公司", 0)],
    [],
    [(85, "苏州欧康诺电子科技股份有限公司", 0)],
    [(86, "珠海星云智联", 0)],
    [(87, "安徽奥飞声学科技有限公司", 0)],
    [(88, "福建蓝海黑石新材料科技有限公司", 0), (88, "中航国际投资有限公司旗下投资基金", 0)],
    [(89, "雅戈尔（需求面积:100-300平方米）集团股份有限公司", 0)],
    [(90, "广东快客电子商务有限公司", 0, "KK集团", 0)],
    [(91, "深圳瑞德林生物技术有限公司", 0)],
    [(92, "NEIWAI内外", 0)],
    [(93, "上海赞思餐饮管理有限公司", 0)],
    [(94, "万达集团股份有限公司", 0)],
    [],
    [(96, "杭州美迪凯光电科技股份有限公司", 0)],
    [(97, "深圳精智达技术股份有限公司", 0)],
    [(98, "苏州诺菲纳米科技有限公司", 0)],
    [(99, "微传智能科技（常州）有限公司", 0)],
    [],
    [(101, "中茵微电子（南京）有限公司", 0)],
    [(102, "冬雷脑科集团", 0)],
    [],
    [(104, "中国证券监督管理委员会", 0)],
    [(105, "软银集团", 0), (105, "The We Company", 0, "WeWork", 0)],
    [(106, "合肥艾创微电子科技有限公司", 0)],
    [],
    [(108, "南京迈得特光学有限公司", 0)],
    [(109, "第四届中国国际进口博览会", 0)],
    [(110, "2021外资企业融入双循环实践案例", 0)],
    [(111, "中国国际服务贸易交易会", 0)],
    [],
    [(113, "纵目科技（上海）股份有限公司", 0)],
    [],
    [(115, "绿景(中国)地产投资有限公司", 0)],
    [(116, "阿基米德半导体（合肥）有限公司", 0)],
    [(117, "上海创米科技有限公司", 0)],
    [(118, "珠海星云智联", 0)],
    [(119, "昇显微电子（苏州）有限公司", 0)],
    [],
    [(121, "Bilibili", 0, "B 站", 0)],
    [(122, "沐曦集成电路（上海）有限公司", 0)],
    [(123, "倍杰特集团股份有限公司", 0)],
    [(124, "广东百合医疗科技股份有限公司", 0)],
    [],
    [(126, "PS-ONE 品思国际艺术教育", 0, "PS-ONE", 1)],
    [(127, "上海芯宿医疗科技有限公司", 0)],
    [(128, "中国银河证券股份有限公司2021年度第七期短期融资券", 0)],
    [(129, "SOHO中国有限公司", 0, "SOHO中国", 1)],
    [(130, "锂电池管理芯片", 0, "BMS芯片", 0)],
    [(131, "乾宇电子材料(深圳)有限公司", 0)],
    [],
    [(133, "无锡华润上华科技有限公司", 0)],
    [(134, "深圳市优必选科技有限公司", 0)],
    [(135, "华虹无锡集成电路研发和制造基地项目", 0)],
    [(136, "达芙妮国际控股有限公司", 0)],
    [(137, "北京联盛德微电子", 0)],
    [(138, "武汉市聚芯微电子有限责任公司", 0)],
    [(139, "上海陆芯电子科技有限公司", 0)],
    [(140, "江苏嘉兆电子有限公司", 0)],
    [(141, "环联连讯科技有限公司", 0), (141, "深圳精控集成半导体有限公司", 0)],
    [],
    [(143, "锅圈食汇", 0)],
    [(144, "广东绿展科技有限公司", 0)],
    [(145, "杭州领挚科技有限公司", 0)],
    [],
    [(147, "上海伴芯科技有限公司", 0, "伴芯科技", 1)],
    [(148, "上海世茂国际广场责任有限公司2017年度第一期资产支持票据", 0, "上海世茂国际广场ABN", 0)],
    [(149, "NEIWAI内外", 0)],
    [(150, "北京大橡科技有限公司", 0)],
    [(151, "杭州左蓝微电子技术有限公司", 0)],
    [(152, "锂电池管理芯片", 0, "BMS芯片", 0)],
    [(153, "中国国际服务贸易交易会", 0)],
    [(154, "苏州纳芯微电子股份有限公司", 0)],
    [(155, "成都矽力科技有限公司", 0)],
    [(156, "三责（上海）新材料科技有限公司", 0)],
    [(157, "合肥欣奕华智能机器有限公司", 0)],
    [(158, "北京欣奕华科技有限公司", 0)],
    [(159, "镕铭微电子（济南）有限公司", 0)],
    [(160, "广州得尔塔影像技术有限公司", 0, "索尼电子华南", 1)],
    [(161, "NEIWAI内外", 0)],
    [],
    [(163, "广东江湾新城物业管理有限公司", 0)],
    [(164, "宁波上融物流有限公司", 0), (164, "苏州工业园区君璞然创业投资合伙企业（有限合伙）", 0)],
    [(165, "珠海星云智联", 0)],
    [(166, "西安奇芯光电科技有限公司", 0)],
    [(167, "智能便利店小麦铺", 0)],
    [(168, "山西查特熊（需求面积:50-100平方米）科技有限公司", 0)],
    [(169, "北京铭镓半导体有限公司", 0)],
    [(170, "加特兰微电子科技（上海）有限公司", 0)],
    [(171, "创世伙伴CCV", 0, "CCV", 1)],
    [(172, "苏宁金融服务(上海)有限公司", 0)],
    [(173, "上海云锋新创投资管理有限公司", 0)],
    [(174, "上海云锋麒泰投资中心(有限合伙)", 0)],
    [(175, "上海云锋新创股权投资管理中心(有限合伙)", 0)],
    [(176, "南京迈得特光学有限公司", 0)],
    [(177, "逐点半导体（上海）有限公司", 0)],
    [(178, "北京中体联合数据科技有限公司", 0)],
    [(179, "AIPARK爱泊车", 0)],
    [(180, "北京忆芯科技有限公司", 0)],
    [(181, "苏州凡赛特材料科技有限公司", 0)],
    [(182, "芯翼信息科技（上海）有限公司", 0)],
    [(183, "北京泽石科技有限公司", 0)],
    [(184, "NEIWAI内外", 0)],
    [(185, "珠海镓未来科技", 0)],
    [(186, "杭州微纳核芯电子科技有限公司", 0)],
    [(187, "深圳海容高新材料科技有限公司", 0)],
    [(188, "江苏京创先进电子科技有限公司", 0)],
    [(189, "苏宁易购集团股份有限公司", 0), (189, "云网万店科技有限公司", 0)],
    [],
    [(191, "杭州光粒科技有限公司", 0, "光粒科技", 1)],
    [(192, "泰科天润半导体", 0)],
    [(193, "鹏钛存储技术(南京)有限公司", 0)],
    [(194, "北京捷联微芯科技有限公司", 0)],
    [],
    [(196, "昇显微电子（苏州）有限公司", 0)],
    [],
    [],
    [(199, "红星美凯龙（需求面积:30000-100000平方米）家居集团股份有限公司", 0)],
    [(200, "南京派格测控科技有限公司", 0)],
    [],
    [(202, "上海红星美凯龙企业发展有限公司", 0)],
    [(203, "深圳市芯茂微电子有限公司", 0)],
    [(204, "EAST WEST BEAUTY 东点西点", 0, "EWB", 0)],
    [(205, "杭州觅酷网络科技有限公司", 0)],
    [(206, "湖南文和友小龙虾有限公司", 0)],
    [(207, "上海显耀显示科技有限公司", 0)],
    [(208, "Tim Hortons（需求面积:120-200平方米）咖啡中国", 0, "Tims咖啡", 0)],
    [],
    [(210, "Mr Zoo 小小动物元", 0)],
    [(211, "Mr Zoo 小小动物元", 0)],
    [(212, "纽福斯生物科技有限公司", 0)],
    [],
    [(214, "集成电路芯片产业扶持资金", 0)],
    [(215, "上海领泰生物医药科技有限公司", 0)],
    [(216, "苏州诺菲纳米科技有限公司", 0)],
    [(217, "长期限含权中期票据", 0)],
    [(218, "深圳市诚亿自动化科技有限公司", 0)],
    [(219, "广州华侨城置业发展有限公司", 0)],
    [(220, "上海鹏鲲置业有限公司", 0)],
    [(221, "度亘激光技术（苏州）有限公司", 0)],
    [(222, "上海稷以科技有限公司", 0)],
    [(223, "上海几何伙伴智能驾驶有限公司", 0)],
    [(224, "华道(上海)生物医药有限公司", 0)],
    [(225, "泰科天润半导体", 0)],
    [(226, "北京龙和隆盛生物技术股份有限公司", 0)],
    [(227, "华源智信半导体（深圳）有限公司", 0)],
    [(228, "武汉红星美凯龙环球家居广场发展有限公司", 0)],
    [(229, "苏州捷研芯电子科技有限公司", 0)],
    [],
    [(231, "上海芯宿医疗科技有限公司", 0)],
    [(232, "《长期合作协议》", 0)],
    [(233, "江苏超芯星半导体有限公司", 0)],
    [],
    [(235, "厦门韫茂科技有限公司", 0)],
    [(236, "Rasi成分实验室", 0, "Rasi", 1)],
    [(237, "九毛九（需求面积:200-300平方米）国际控股有限公司", 0)],
    [(238, "珠海市芯动力科技有限公司", 0)],
    [(239, "英诺达（成都）电子科技有限公司", 0)],
    [(240, "螳螂慧视科技有限公司", 0)],
    [],
    [(242, "上海闻融企业管理合伙企业（有限合伙）", 0)],
    [(243, "智慧云服网络科技有限公司", 0)],
    [(244, "宗地的商品住宅", 0)],
    [(245, "合肥边缘智芯科技有限公司", 0)],
    [(246, "上海萧雅生物科技股份有限公司", 0)],
    [(247, "Tabula Rasa", 0, "TR", 0)],
    [(248, "北京王小卤网络科技有限公司", 0)],
    [(249, "万物云空间科技服务股份有限公司", 0)],
    [(250, "深圳市誉鹰物业服务有限公司", 0)],
    [(251, "锅圈供应链（上海）有限公司", 0)],
    [(252, "北京微纳星空科技有限公司", 0)],
    [(253, "苏州诺菲纳米科技有限公司", 0)],
    [(254, "杭州中欣晶圆半导体股份有限公司", 0)],
    [(255, "《2016年12月40家典型上市房企融资报告》", 0, "《报告》", 0)],
    [(256, "芯行纪科技有限公司", 0)],
    [(257, "广东欧莱高新材料股份有限公司", 0)],
    [(258, "上海芯钛信息科技有限公司", 0)],
    [(259, "合肥埃科光电科技有限公司", 0)],
    [(260, "芯启源电子科技有限公司", 0)],
    [(261, "深圳市优必选科技股份有限公司", 0)],
    [(262, "Hudsons Bay百货", 0, "HBC", 0)],
    [(263, "深圳尚阳通科技有限公司", 0)],
    [(264, "芯行纪科技有限公司", 0)],
    [(265, "华致酒行(300755,股吧)连锁管理股份有限公司", 0)],
    [(266, "名品世家酒业连锁股份有限公司", 0)],
    [(267, "北京易酒批电子商务有限公司", 0), (267, "河南酒便利商业股份有限公司", 0)],
    [(268, "江苏省产业技术研究院智能集成电路设计技术研究所", 0)],
    [(269, "抖音服务商", 0, "DP", 0)],
    [(270, "上海芯钛信息科技有限公司", 0)],
    [(271, "脉砥微电子（杭州）有限公司", 0)],
    [(272, "武汉优炜芯科技有限公司", 0)],
    [(273, "旭辉控股（集团）有限公司", 0)],
    [(274, "《中共海口市委关于制定国民经济和社会发展第十四个五年规划和二〇三五年远景目标的建议》", 0, "《规划建议》", 0)],
    [(275, "深圳市合创资本管理有限公司", 0)],
    [(276, "清控金信资本管理（北京）有限公司", 0)],
    [(277, "深圳市恒信华业股权投资基金管理有限公司", 0)],
    [(278, "西安声必捷信息科技有限公司", 0)],
    [(279, "中国半导体合规联盟", 0)],
    [(280, "中茵微电子（南京）有限公司", 0)],
    [(281, "上海合见工业软件集团有限公司", 0)],
    [(282, "UniVista Simulator", 0, "UVS", 0)],
    [(283, "南京三迭纪医药科技有限公司", 0)],
    [(284, "西安恩狄集成电路有限公司", 0)],
    [(285, "珠海星云智联", 0)],
    [(286, "宁波泰睿思微电子有限公司", 0)],
    [(287, "PARTY KING（需求面积:1500-3000平方米）运动街区", 0, "PARTY KING", 1)],
    [(288, "诺磊科技（南京）有限公司", 0)],
    [(289, "苏州云途半导体有限公司", 0)],
    [(290, "成都氮矽科技有限公司", 0)],
    [(291, "武汉喻芯半导体有限公司", 0)],
    [(292, "日日煮（需求面积:300-500平方米）DayDayCook", 0)],
    [(293, "知象光电科技有限公司", 0)],
    [(294, "珠海格力集团有限公司", 0)],
    [(295, "深流微智能科技（深圳）有限公司", 0)],
    [(296, "益思芯科技（上海）有限公司", 0)],
    [(297, "《关于经济下行期加大民企抒困力度的建议》", 0, "《提案》", 0)],
    [(298, "上海韬润半导体有限公司", 0)],
    [],
    [(300, "《2019-2020中国人工智能计算力发展评估报告》", 0, "《报告》", 0)],
    [(301, "亮风台（上海）信息科技有限公司", 0)],
    [(302, "江苏壹度科技股份有限公司", 0)],
    [(303, "杭州奥创光子技术有限公司", 0)],
    [(304, "臻驱科技（上海）有限公司", 0)],
    [(305, "纽福斯生物科技有限公司", 0)],
    [],
    [(307, "亮风台（上海）信息科技有限公司", 0)],
    [(308, "本征信息技术（上海）有限公司", 0)],
    [(309, "北京灵汐科技有限公司", 0)],
    [(310, "楚山（深圳）新能源科技有限公司", 0)],
    [],
    [],
    [(313, "赛昉科技有限公司", 0)],
    [(314, "Little Ondine小奥汀", 0)],
    [(315, "上海稷以科技有限公司", 0)],
    [(316, "上海赞思餐饮管理有限公司", 0)],
    [(317, "Particle Fever粒子狂热", 0, "PF", 0)],
    [(318, "Nano Labs Ltd", 0, "Nano Labs", 1)],
    [(319, "杭州嗨宝贝科技有限公司", 0, "Hibobi", 0)],
    [(320, "苏州徴格半导体有限公司", 0)],
    [(321, "magmode名堂", 0)],
    [(322, "Boom Boom Mart（需求面积:150-200平方米） 繁荣集市", 0, "BBM", 0)],
    [(323, "南京集澈电子科技有限公司", 0)],
    [(324, "珠海赛纳三维科技有限公司", 0)],
    [(325, "美味不用等", 0)],
    [(326, "拓荆科技股份有限公司", 0)],
    [(327, "深圳市酷开网络科技股份有限公司", 0)],
    [(328, "深圳东创技术股份有限公司", 0)],
    [(329, "上海芯导电子科技股份有限公司", 0)],
    [(330, "浙江孔辉汽车科技有限公司", 0)],
    [(331, "深圳小鹅网络技术有限公司", 0)],
    [(332, "中国光谷AI科技联盟", 0, "AI科技联盟", 1), (332, "长江清科AI产业基金", 0, "AI产业基金", 1)],
    [(333, "Tim Hortons", 0, "Tims咖啡", 0)],
    [(334, "上海显耀显示科技有限公司", 0)],
    [(335, "台州观宇科技有限公司", 0)],
    [(336, "珠海冠宇电池股份有限公司", 0)],
    [(337, "东方茸世（烟台）创业投资合伙企业（有限合伙）", 0)],
    [(338, "上海先楫半导体科技有限公司", 0)],
    [(339, "武汉喻芯半导体有限公司", 0)],
    [(340, "上海世茂国际广场有限公司2017年第一期资产支持票据", 0, "世茂广场ABN", 0)],
    [(341, "爱瑞无线科技（厦门）有限公司", 0)],
    [(342, "intelligent Vehicle Base Brain", 0, "iVBB", 0)],
    [(343, "臻驱科技（上海）有限公司", 0)],
    [(344, "九龙城贾炳达道（", 0)],
    [(345, "马鞍山乌溪沙一带", 0)],
    [(346, "黑芝麻智能科技有限公司", 0)],
    [(347, "新华联控股有限公司", 0)],
    [(348, "《珠海市促进集成电路产业发展专项资金管理实施细则》", 0, "《实施细则》", 0)],
    [(349, "九号有限公司", 0)],
    [],
    [(351, "武汉杰开科技有限公司", 0)],
    [(352, "湖南文和友小龙虾有限公司", 0)],
    [(353, "华芯拓远（天津）科技有限公司", 0)],
    [(354, "知象光电科技有限公司", 0)],
    [(355, "西安声必捷信息科技有限公司", 0)],
    [],
    [(357, "JUST A COOL BRAND", 0, "JACB", 0)],
    [(358, "北京瞰瞰智能科技有限公司", 0)],
    [(359, "深圳市灵明光子科技有限公司", 0)],
    [(360, "《证券期货经营机构私募资产管理计划备案管理规范第4号-私募资产管理计划投资房地产开发企业、项目》", 0, "4号文", 0)],
    [],
    [(362, "广州越秀融资租赁有限公司", 0)],
    [(363, "苏州易锐光电科技有限公司", 0)],
    [(364, "山东斯奈克宠物用品公司", 0)],
    [(365, "广东芯聚能半导体有限公司", 0)],
    [(366, "北京汉博商业管理股份有限公司", 0)],
    [(367, "北京力通通信有限公司", 0)],
    [(368, "Tim Hortons", 0, "Tims咖啡", 0)],
    [(369, "上海圣治光电科技有限公司", 0)],
    [(370, "上海果栗自动化科技有限公司", 0)],
    [(371, "资产支持证券", 0, "ABS", 0)],
    [(372, "资产支持票据", 0, "ABN", 0)],
    [(373, "永曜集团有限公司", 0)],
    [(374, "紫光云技术有限公司", 0)],
    [(375, "上海格林兰投资企业(有限合伙)", 0)],
    [],
    [(377, "深圳市优必选科技有限公司", 0)],
    [(378, "深圳奥拦科技有限责任公司", 0)],
    [(379, "九毛九（需求面积:200-300平方米）国际控股有限公司", 0)],
    [(380, "福建省乐家物联科技有限公司", 0)],
    [(381, "2017窝趣品牌战略发布会", 0)],
    [(382, "杭州视光半导体科技有限公司", 0)],
    [(383, "中国国有资本风险投资基金", 0)],
    [(384, "深圳前海麦格美科技有限公司", 0)],
    [],
    [(386, "北京超材信息科技有限公司", 0)],
    [(387, "蚂蚁集团", 0, "蚂蚁金服", 0)],
    [(388, "深圳曦华科技有限公司", 0)],
    [(389, "妍丽（需求面积:150-200平方米）化妆品（中国）有限公司", 0)],
    [(390, "爸爸糖手工吐司", 0)],
    [],
    [],
    [(393, "西安智多晶微电子有限公司", 0)],
    [(394, "电子科技大学重庆微电子产业技术研究院", 0)],
    [(395, "深圳电目科技有限公司", 0)],
    [(396, "南京超能鹿战队（需求面积:100-200平方米）餐饮管理有限公司", 0)],
    [(397, "阳光海天停车产业集团", 0)],
    [(398, "翱捷科技股份有限公司", 0)],
    [(399, "黄山芯微电子股份有限公司", 0)],
    [(400, "深圳前海蓝点电子信息产业股权投资合伙企业(有限合伙)", 0)],
    [(401, "南京集澈电子科技有限公司", 0)],
    [(402, "冬雷脑科集团", 0)],
    [(403, "武汉中百便利店有限公司", 0, "中百罗森", 0)],
    [(404, "日本国株式会社罗森", 0)],
    [],
    [],
    [(407, "深圳市中天安驰有限责任公司", 0)],
    [(408, "《关于加强产融合作推动工业绿色发展的指导意见》", 0, "《指导意见》", 0)],
    [(409, "永辉青禾商业保理（重庆）有限公司", 0)],
    [(410, "大连万达商业管理集团股份有限公司", 0)],
    [(411, "深圳市邦得凌触控显示技术有限公司", 0)],
    [(412, "乡村基（需求面积:200-300平方米）（重庆）投资有限公司", 0)],
    [(413, "“上行e链”在线供应链金融服务平台", 0, "上行e链", 1)],
    [(414, "太景科技（南京）有限公司", 0)],
    [(415, "Premiere Beaute", 0, "PB", 0)],
    [(416, "灵动微电子", 0)],
    [(417, "华联发展集团有限公司", 0)],
    [(418, "杭州锦江集团有限公司", 0)],
    [(419, "上海紫燕食品股份有限公司", 0)],
    [(420, "深圳前海麦格美科技有限公司", 0)],
    [(421, "广西慧金科技股份有限公司", 0), (421, "北京天下秀科技股份有限公司", 0)],
    [(422, "厦门澎湃微电子有限公司", 0)],
    [],
    [(424, "北京集创北方科技股份有限公司", 0)],
    [(425, "杭州左蓝微电子技术有限公司", 0)],
    [(426, "浙江光特科技有限公司", 0)],
    [(427, "加拿大哈得逊湾公司", 0, "HBC", 0)],
    [(428, "上海索迪龙自动化有限公司", 0)],
    [(429, "江苏京创先进电子科技有限公司", 0)],
    [],
    [(431, "成都威频科技有限公司", 0)],
    [(432, "合肥欣奕华智能机器有限公司", 0)],
    [(433, "北京欣奕华科技有限公司", 0)],
    [(434, "重庆博茂餐饮集团有限公司", 0)],
    [(435, "上海天数智芯半导体有限公司", 0)],
    [(436, "北京天艺同歌国际文化艺术有限公司", 0), (436, "北京新动力优质企业发展基金", 0)],
    [(437, "The Daily Cut", 0, "TDC", 0)],
    [(438, "孚远新材料（上海）有限公司", 0)],
    [(439, "北京中体联合数据科技有限公司", 0)],
    [(440, "乾宇电子材料(深圳)有限公司", 0)],
    [(441, "未来茶浪WILLCHA", 0, "WILLCHA", 1)],
    [(442, "国汽智图（北京）科技有限公司", 0)],
    [],
    [],
    [(445, "苏州诺菲纳米科技有限公司", 0)],
    [(446, "武汉喻芯半导体有限公司", 0)],
    [(447, "广芯微电子（广州）股份有限公司", 0)],
    [(448, "中国科技产业投资管理有限公司", 0)],
    [(449, "宏芯气体（上海）有限公司", 0)],
]

train_list = []
for i, dt in enumerate(data_train):
    label = data_label[i]
    if len(label) == 0:
        continue
    # if len(dt[1]) == 0:
    #     continue
    # print(i, dt)
    sentence = dt[0]
    iv = 0
    jv = 0
    dv = dict()
    for s in sentence:
        if s not in [" "]:
            dv[jv] = iv
            iv += 1
        jv += 1

    full_short_list = []
    true_res = []
    for j, lb in enumerate(label):
        # print(i, lb[0])
        assert i == lb[0]
        if len(lb) == 3:
            pt = lb[1].replace("(", "\(").replace(")", "\)")
            res = [(r.group(0), r.span(0)) for r in re.finditer(pt, sentence)]
            if len(res) == 0:
                print(i, lb[1], sentence)
                raise Exception
            span = res[lb[2]]
            # print(dt[1], sentence)
            short = dt[1][j]
            full_short_list.append({"key": (dv[span[1][0]], dv[span[1][1]-1]+1, dv[short[1][0]], dv[short[1][1]-1]+1)})
            true_res.append((span[0], short[0]))
        else:
            # print(lb, sentence)
            f_pt = lb[1].replace("(", "\(").replace(")", "\)")
            f_res = [(r.group(0), r.span(0)) for r in re.finditer(f_pt, sentence)]
            s_pt = lb[3]
            s_res = [(r.group(0), r.span(0)) for r in re.finditer(s_pt, sentence)]

            span = f_res[lb[2]]
            s_span = s_res[lb[4]]
            full_short_list.append({"key": (dv[span[1][0]], dv[span[1][1]-1]+1, dv[s_span[1][0]], dv[s_span[1][1]-1]+1)})
            true_res.append((span[0], s_span[0]))
    # print(full_short_list)
    # print(true_res)
    train_list.append({
        "sentence": [s for s in sentence if s not in [" "]],
        "full_short_list": full_short_list,
        "orient_sentence": sentence,
        "golden_answer": true_res
    })

# print(len(train_list))
# for dt in train_list:
#     # print(dt["sentence"])
#     for _, x, y, _ in dt["full_short_list"]:
#         print(dt["sentence"])
#         assert x<y
# sentence = "集微网消息，近日，成都威频科技有限公司（以下简称“威频科技”）正式宣布获得数千万元A 轮融资，本轮融资由国投创业领投，老股东北极光创投继续加码"
# # print(re.findall("（以下简称“([\u4e00-\u9fa5]+?)”）", sentence))
# rs = []
# for pattern in pattern_list:
#     res = re.findall(pattern, sentence)
#
#     if res:
#         rs += [(r.group(1), r.span(1)) for r in re.finditer(pattern, sentence)]
#         # data_train.append((dt, ))
#         # hit += 1
#         # print(res)
#         state = 1
# # if state == 0:
# print(rs)
# rs.sort(key=lambda x: x[1][0])
